# üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –∑ –ª—ñ—Ü–µ–Ω–∑—ñ—î—é - –ü–û–í–ù–ï –†–Ü–®–ï–ù–ù–Ø

## ‚úÖ **–©–û –ë–£–õ–û –í–ò–ü–†–ê–í–õ–ï–ù–û:**

### **1. –°—Ö–µ–º–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (server/create_tables.sql)**
- ‚úÖ **–î–æ–¥–∞–Ω–æ –ø–æ–ª–µ `activated_at`** –≤ —Ç–∞–±–ª–∏—Ü—é `user_licenses`
- ‚úÖ **–ó–º—ñ–Ω–µ–Ω–æ `expires_at` ‚Üí `days_valid`** –≤ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ —ñ–Ω–¥–µ–∫—Å–∏** –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- ‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏**

### **2. –õ–æ–≥—ñ–∫–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –ª—ñ—Ü–µ–Ω–∑—ñ—ó (server/src/lib/license-validator.ts)**
- ‚úÖ **–ü–µ—Ä–µ–ø–∏—Å–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó** - —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `days_valid` + `activated_at`
- ‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ—Ä—è–¥–æ–∫ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫** - —Å–ø–æ—á–∞—Ç–∫—É –æ—Ç—Ä–∏–º—É—î–º–æ `userLicense`, –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ç–µ—Ä–º—ñ–Ω
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ª—ñ—Ü–µ–Ω–∑—ñ–π** –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –Ω–æ–≤–æ—é –ª–æ–≥—ñ–∫–æ—é
- ‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–æ –æ–±—Ä–æ–±–∫—É offline –ª—ñ–º—ñ—Ç—ñ–≤**

### **3. –õ–æ–≥—ñ–∫–∞ heartbeat (server/src/app/api/heartbeat/route.ts)**
- ‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞** - —Ç–µ–ø–µ—Ä –ù–ï –±–ª–æ–∫—É—î –ø–ª–∞–≥—ñ–Ω –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó
- ‚úÖ **–î–æ–∑–≤–æ–ª–µ–Ω–æ —Ä–æ–±–æ—Ç—É –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó** - –ø–ª–∞–≥—ñ–Ω –ø—Ä–∞—Ü—é—î –≤ –¥–µ–º–æ —Ä–µ–∂–∏–º—ñ
- ‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è** –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### **4. URL —Å–µ—Ä–≤–µ—Ä–∞ (plugin/proGran3.rb, plugin/proGran3/security/license_manager.rb)**
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ URL —Å–µ—Ä–≤–µ—Ä–∞** –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∏–π: `https://progran3-tracking-server-7fmk1r90v-provis3ds-projects.vercel.app`
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ URL** –≤ –æ–±–æ—Ö —Ñ–∞–π–ª–∞—Ö

### **5. API —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª—ñ—Ü–µ–Ω–∑—ñ–π (server/src/app/api/admin/licenses/route.ts)**
- ‚úÖ **–ó–º—ñ–Ω–µ–Ω–æ `expires_at` ‚Üí `days_valid`** –≤ POST –º–µ—Ç–æ–¥—ñ
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ –ª–æ–≥—ñ–∫—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** –ª—ñ—Ü–µ–Ω–∑—ñ–π
- ‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é** –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º

### **6. –ú—ñ–≥—Ä–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (server/migrations/006_fix_license_schema.sql)**
- ‚úÖ **–°—Ç–≤–æ—Ä–µ–Ω–æ –º—ñ–≥—Ä–∞—Ü—ñ—é** –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ—ó –ë–î
- ‚úÖ **–î–æ–¥–∞–Ω–æ –ø–æ–ª–µ `activated_at`** —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ —ñ—Å–Ω—É—é—á—ñ –∑–∞–ø–∏—Å–∏** - –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `activated_at = created_at`
- ‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ —ñ–Ω–¥–µ–∫—Å–∏** –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

## üöÄ **–†–ï–ó–£–õ–¨–¢–ê–¢ –í–ò–ü–†–ê–í–õ–ï–ù–¨:**

### **–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏:**
1. **–ê–¥–º—ñ–Ω —Å—Ç–≤–æ—Ä—é—î –ª—ñ—Ü–µ–Ω–∑—ñ—é** –∑ `days_valid` (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ –¥—ñ—ó)
2. **–ö–ª—ñ—î–Ω—Ç –∞–∫—Ç–∏–≤—É—î –ª—ñ—Ü–µ–Ω–∑—ñ—é** - –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è `activated_at` –≤ `user_licenses`
3. **–¢–µ—Ä–º—ñ–Ω –¥—ñ—ó —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è** —è–∫ `activated_at + days_valid`
4. **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø–µ—Ä–µ–≤—ñ—Ä—è—î** —á–∏ –Ω–µ –º–∏–Ω—É–≤ —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó
5. **–ü–ª–∞–≥—ñ–Ω –ù–ï –±–ª–æ–∫—É—î—Ç—å—Å—è** –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó - –ø—Ä–∞—Ü—é—î –≤ –¥–µ–º–æ —Ä–µ–∂–∏–º—ñ

### **–ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏:**
- ‚úÖ **–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ñ—Å—Ç—å** - —Ç–µ—Ä–º—ñ–Ω –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó
- ‚úÖ **–ì–Ω—É—á–∫—ñ—Å—Ç—å** - —Ä—ñ–∑–Ω—ñ —Ç–µ—Ä–º—ñ–Ω–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –ª—ñ—Ü–µ–Ω–∑—ñ–π
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –∞–¥–º—ñ–Ω –≤–∫–∞–∑—É—î —Ç—ñ–ª—å–∫–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤
- ‚úÖ **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å** - –º–µ–Ω—à–µ –ø–æ–º–∏–ª–æ–∫ –∑ —á–∞—Å–æ–≤–∏–º–∏ –∑–æ–Ω–∞–º–∏
- ‚úÖ **–î–µ–º–æ —Ä–µ–∂–∏–º** - –ø–ª–∞–≥—ñ–Ω –ø—Ä–∞—Ü—é—î –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó

## üìã **–Ü–ù–°–¢–†–£–ö–¶–Ü–á –î–õ–Ø –†–û–ó–ì–û–†–¢–ê–ù–ù–Ø:**

### **1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:**
```sql
-- –ó–∞–ø—É—Å—Ç—ñ—Ç—å –º—ñ–≥—Ä–∞—Ü—ñ—é
\i server/migrations/006_fix_license_schema.sql
```

### **2. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω
vercel deploy
```

### **3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞:**
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å SketchUp –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ
ProGran3.reload
```

## üîç **–ü–ï–†–ï–í–Ü–†–ö–ê –í–ò–ü–†–ê–í–õ–ï–ù–¨:**

### **1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ö–µ–º–∏ –ë–î:**
```sql
-- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—å
SELECT column_name, data_type FROM information_schema.columns 
WHERE table_name IN ('licenses', 'user_licenses')
ORDER BY table_name, column_name;
```

### **2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ API:**
```bash
# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª—ñ—Ü–µ–Ω–∑—ñ—ó
curl -X POST https://progran3-tracking-server-7fmk1r90v-provis3ds-projects.vercel.app/api/admin/licenses \
  -H "Content-Type: application/json" \
  -d '{"days_valid": 30, "max_activations": 1}'
```

### **3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–ª–∞–≥—ñ–Ω–∞:**
```ruby
# –í –∫–æ–Ω—Å–æ–ª—ñ SketchUp
ProGran3.tracking_status
ProGran3.has_license?
```

## ‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–Ü –ó–ú–Ü–ù–ò:**

### **–î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:**
- –¢–µ–ø–µ—Ä —Å—Ç–≤–æ—Ä—é—é—Ç—å –ª—ñ—Ü–µ–Ω–∑—ñ—ó –∑ `days_valid` –∑–∞–º—ñ—Å—Ç—å `expires_at`
- –õ—ñ—Ü–µ–Ω–∑—ñ—ó –∞–∫—Ç–∏–≤—É—é—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–∞–º–∏, –∞ –Ω–µ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∑ email

### **–î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤:**
- –ü–ª–∞–≥—ñ–Ω –ù–ï –±–ª–æ–∫—É—î—Ç—å—Å—è –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `days_valid` + `activated_at`
- URL —Å–µ—Ä–≤–µ—Ä–∞ –æ–Ω–æ–≤–ª–µ–Ω–æ

### **–î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:**
- –õ—ñ—Ü–µ–Ω–∑—ñ—ó –∞–∫—Ç–∏–≤—É—é—Ç—å—Å—è –≤ –ø–ª–∞–≥—ñ–Ω—ñ
- –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó
- –ü–ª–∞–≥—ñ–Ω –ø—Ä–∞—Ü—é—î –±–µ–∑ –ª—ñ—Ü–µ–Ω–∑—ñ—ó –≤ –¥–µ–º–æ —Ä–µ–∂–∏–º—ñ

## üéØ **–°–¢–ê–¢–£–°: –í–°–ï –í–ò–ü–†–ê–í–õ–ï–ù–û!**

**–î–∞—Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** 2024-12-19  
**–í–µ—Ä—Å—ñ—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–í–ù–Ü–°–¢–Æ –í–ò–ü–†–ê–í–õ–ï–ù–û**

---

**–ê–≤—Ç–æ—Ä:** ProGran3 Development Team  
**–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ:** –í—Å—ñ –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** ‚úÖ
