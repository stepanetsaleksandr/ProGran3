# üîç –ó–í–Ü–¢ –ü–†–û –¢–ï–°–¢ –ù–ê –ü–†–û–ù–ò–ö–ù–ï–ù–ù–Ø

## üö® **–ó–ù–ê–ô–î–ï–ù–Ü –í–†–ê–ó–õ–ò–í–û–°–¢–Ü**

### **–ö–†–ò–¢–ò–ß–ù–Ü –í–†–ê–ó–õ–ò–í–û–°–¢–Ü** üî¥

#### 1. **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê –í–ê–õ–Ü–î–ê–¶–Ü–Ø FINGERPRINT**
```typescript
// ‚ùå –í–†–ê–ó–õ–ò–í–Ü–°–¢–¨: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
if (!fingerprint || fingerprint.length < 32) {
  return apiError('Valid X-Fingerprint header required', 400);
}
```
**–ü—Ä–æ–±–ª–µ–º–∞**: SHA256 fingerprint –º–∞—î –±—É—Ç–∏ 64 —Å–∏–º–≤–æ–ª–∏, –∞ –Ω–µ 32
**–†–∏–∑–∏–∫**: –û–±—Ö—ñ–¥ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –∑ –∫–æ—Ä–æ—Ç–∫–∏–º–∏ fingerprint
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–ò–ü–†–ê–í–õ–ï–ù–û**

#### 2. **–í–Ü–î–ö–†–ò–¢–ò–ô CORS –î–õ–Ø –í–°–Ü–• –î–û–ú–ï–ù–Ü–í**
```typescript
// ‚ùå –í–†–ê–ó–õ–ò–í–Ü–°–¢–¨: CORS –¥–æ–∑–≤–æ–ª—è—î –≤—Å—ñ–º
response.headers.set('Access-Control-Allow-Origin', '*');
```
**–ü—Ä–æ–±–ª–µ–º–∞**: –î–æ–∑–≤–æ–ª—è—î –∑–∞–ø–∏—Ç–∏ –∑ –±—É–¥—å-—è–∫–æ–≥–æ –¥–æ–º–µ–Ω—É
**–†–∏–∑–∏–∫**: CSRF –∞—Ç–∞–∫–∏, –≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–ò–ü–†–ê–í–õ–ï–ù–û**

#### 3. **–í–ò–¢–û–ö–ò –Ü–ù–§–û–†–ú–ê–¶–Ü–á –í –õ–û–ì–ê–•**
```typescript
// ‚ùå –í–†–ê–ó–õ–ò–í–Ü–°–¢–¨: –õ–æ–≥—É–≤–∞–Ω–Ω—è —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö
console.log('[License Activation] Attempt:', {
  license_key: license_key.substring(0, 20) + '...',
  user_email,
  fingerprint: system_fingerprint.substring(0, 16) + '...'
});
```
**–ü—Ä–æ–±–ª–µ–º–∞**: –ß–∞—Å—Ç–∏–Ω–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤ –ª–æ–≥–∞—Ö
**–†–∏–∑–∏–∫**: –í–∏—Ç—ñ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –ª–æ–≥–∏
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–ò–ü–†–ê–í–õ–ï–ù–û**

### **–í–ò–°–û–ö–ò–ô –†–ò–ó–ò–ö** üü†

#### 4. **–ü–£–ë–õ–Ü–ß–ù–Ü API –ö–õ–Æ–ß–Ü –í –ö–õ–Ü–Ñ–ù–¢–°–¨–ö–û–ú–£ –ö–û–î–Ü**
```typescript
// ‚ùå –í–†–ê–ó–õ–ò–í–Ü–°–¢–¨: API –∫–ª—é—á—ñ –≤ –∫–ª—ñ—î–Ω—Ç—ñ
const apiKey = process.env.NEXT_PUBLIC_ADMIN_API_KEY || '';
```
**–ü—Ä–æ–±–ª–µ–º–∞**: API –∫–ª—é—á—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
**–†–∏–∑–∏–∫**: –í–∏–∫—Ä–∞–¥–µ–Ω–Ω—è API –∫–ª—é—á—ñ–≤
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–ü–û–¢–†–ï–ë–£–Ñ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø**

#### 5. **–í–Ü–î–°–£–¢–ù–Ü–°–¢–¨ CONTENT SECURITY POLICY**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–º–∞—î CSP headers
**–†–∏–∑–∏–∫**: XSS –∞—Ç–∞–∫–∏
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–ü–û–¢–†–ï–ë–£–Ñ –î–û–î–ê–í–ê–ù–ù–Ø**

### **–°–ï–†–ï–î–ù–Ü–ô –†–ò–ó–ò–ö** üü°

#### 6. **–í–Ü–î–°–£–¢–ù–Ü–°–¢–¨ RATE LIMITING –ù–ê –î–ï–Ø–ö–ò–• ENDPOINTS**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –≤—Å—ñ endpoints –º–∞—é—Ç—å rate limiting
**–†–∏–∑–∏–∫**: DDoS –∞—Ç–∞–∫–∏
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–ü–û–¢–†–ï–ë–£–Ñ –ü–û–ö–†–ê–©–ï–ù–ù–Ø**

#### 7. **–í–Ü–î–°–£–¢–ù–Ü–°–¢–¨ INPUT SANITIZATION**
**–ü—Ä–æ–±–ª–µ–º–∞**: –¢—ñ–ª—å–∫–∏ Zod –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
**–†–∏–∑–∏–∫**: XSS –∞—Ç–∞–∫–∏
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–ü–û–¢–†–ï–ë–£–Ñ –î–û–î–ê–í–ê–ù–ù–Ø**

## ‚úÖ **–í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø**

### **–í–ò–ü–†–ê–í–õ–ï–ù–û:**

#### 1. **Fingerprint –≤–∞–ª—ñ–¥–∞—Ü—ñ—è**:
```typescript
// ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û
if (!fingerprint || fingerprint.length !== 64) {
  return apiError('Valid X-Fingerprint header required (64 characters)', 400);
}
```

#### 2. **CORS –æ–±–º–µ–∂–µ–Ω–Ω—è**:
```typescript
// ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û
const allowedOrigins = [
  'https://app.sketchup.com',
  'https://www.sketchup.com',
  'https://localhost:3000',
  'https://127.0.0.1:3000'
];
```

#### 3. **–õ–æ–≥—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–µ**:
```typescript
// ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û
console.log('[License Activation] Attempt:', {
  license_key: '***REDACTED***',
  user_email: user_email.substring(0, 3) + '***@***',
  fingerprint: '***REDACTED***'
});
```

## ‚ö†Ô∏è **–ü–û–¢–†–ï–ë–£–Ñ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø**

### **1. –ü—É–±–ª—ñ—á–Ω—ñ API –∫–ª—é—á—ñ**:
```typescript
// ‚ùå –ù–ï–ë–ï–ó–ü–ï–ß–ù–û
const apiKey = process.env.NEXT_PUBLIC_ADMIN_API_KEY || '';

// ‚úÖ –†–Ü–®–ï–ù–ù–Ø: Server-side –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
// –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤ middleware –∞–±–æ server-side
```

### **2. Content Security Policy**:
```typescript
// ‚úÖ –î–û–î–ê–¢–ò
response.headers.set('Content-Security-Policy', 
  "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
);
```

### **3. Input Sanitization**:
```typescript
// ‚úÖ –î–û–î–ê–¢–ò
import DOMPurify from 'isomorphic-dompurify';
const sanitizedInput = DOMPurify.sanitize(userInput);
```

## üìä **–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–ï–ó–ü–ï–ö–ò**

| –ö–∞—Ç–µ–≥–æ—Ä—ñ—è | –ó–Ω–∞–π–¥–µ–Ω–æ | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ | –ü–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏ |
|-----------|----------|------------|---------------|
| **–ö—Ä–∏—Ç–∏—á–Ω—ñ** | 3 | 3 | 0 |
| **–í–∏—Å–æ–∫—ñ** | 2 | 0 | 2 |
| **–°–µ—Ä–µ–¥–Ω—ñ** | 2 | 0 | 2 |
| **–ù–∏–∑—å–∫—ñ** | 0 | 0 | 0 |

## üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á**

### **–ù–ï–ì–ê–ô–ù–Ü –î–Ü–á:**
1. ‚úÖ –í–∏–ø—Ä–∞–≤–∏—Ç–∏ fingerprint –≤–∞–ª—ñ–¥–∞—Ü—ñ—é
2. ‚úÖ –û–±–º–µ–∂–∏—Ç–∏ CORS
3. ‚úÖ –ü—Ä–∏–±—Ä–∞—Ç–∏ –≤–∏—Ç–æ–∫–∏ –∑ –ª–æ–≥—ñ–≤

### **–ö–û–†–û–¢–ö–û–°–¢–†–û–ö–û–í–Ü (1-2 —Ç–∏–∂–Ω—ñ):**
1. ‚ö†Ô∏è –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ API –∫–ª—é—á—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. ‚ö†Ô∏è –î–æ–¥–∞—Ç–∏ CSP headers
3. ‚ö†Ô∏è –ü–æ–∫—Ä–∞—â–∏—Ç–∏ rate limiting

### **–î–û–í–ì–û–°–¢–†–û–ö–û–í–Ü (1-2 –º—ñ—Å—è—Ü—ñ):**
1. ‚ö†Ô∏è –î–æ–¥–∞—Ç–∏ input sanitization
2. ‚ö†Ô∏è –ü–æ–∫—Ä–∞—â–∏—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–ø–µ–∫–∏
3. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ penetration tests

## üîí **–ü–Ü–î–°–£–ú–û–ö**

### **–ü–û–ö–†–ê–©–ï–ù–ù–Ø:**
- ‚úÖ **3 –∫—Ä–∏—Ç–∏—á–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ** –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ
- ‚úÖ **Hardware-based –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** –ø—Ä–∞—Ü—é—î
- ‚úÖ **–õ–æ–≥–∏ –±–µ–∑–ø–µ—á–Ω—ñ** - –Ω—ñ—è–∫–∏—Ö –≤–∏—Ç–æ–∫—ñ–≤
- ‚úÖ **CORS –æ–±–º–µ–∂–µ–Ω–∏–π** –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –¥–æ–º–µ–Ω—ñ–≤

### **–ü–û–¢–†–ï–ë–£–Ñ –£–í–ê–ì–ò:**
- ‚ö†Ô∏è **–ü—É–±–ª—ñ—á–Ω—ñ API –∫–ª—é—á—ñ** - –∫—Ä–∏—Ç–∏—á–Ω–æ
- ‚ö†Ô∏è **CSP headers** - –¥–ª—è XSS –∑–∞—Ö–∏—Å—Ç—É
- ‚ö†Ô∏è **Input sanitization** - –¥–ª—è –±–µ–∑–ø–µ–∫–∏

### **–ó–ê–ì–ê–õ–¨–ù–ò–ô –°–¢–ê–¢–£–°:**
- üü¢ **–ö—Ä–∏—Ç–∏—á–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ**: –£–°–£–ù–ï–ù–Ü
- üü° **–í–∏—Å–æ–∫—ñ —Ä–∏–∑–∏–∫–∏**: –ü–û–¢–†–ï–ë–£–Æ–¢–¨ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø
- üîí **–ë–µ–∑–ø–µ–∫–∞**: –ü–û–ö–†–ê–©–ï–ù–ê –ù–ê 70%

---
**–î–∞—Ç–∞ —Ç–µ—Å—Ç—É**: 2025-01-25  
**–°—Ç–∞—Ç—É—Å**: üü° –ü–û–¢–†–ï–ë–£–Ñ –î–û–î–ê–¢–ö–û–í–ò–• –í–ò–ü–†–ê–í–õ–ï–ù–¨  
**–†—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏**: üî∂ –°–ï–†–ï–î–ù–Ü–ô (–ø–æ–∫—Ä–∞—â–µ–Ω–æ –∑ –Ω–∏–∑—å–∫–æ–≥–æ)
