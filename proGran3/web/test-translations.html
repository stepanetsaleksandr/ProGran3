<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Test Translations - ProGran3</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #1a252f 100%);
      min-height: 100vh;
      color: white;
    }
    
    .test-section {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      backdrop-filter: blur(10px);
    }
    
    .test-section h2 {
      color: #4a90e2;
      margin-top: 0;
    }
    
    .language-buttons {
      display: flex;
      gap: 10px;
      margin: 20px 0;
    }
    
    .lang-btn {
      padding: 10px 20px;
      background: rgba(74, 144, 226, 0.2);
      border: 1px solid rgba(74, 144, 226, 0.4);
      border-radius: 8px;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .lang-btn:hover {
      background: rgba(74, 144, 226, 0.3);
    }
    
    .lang-btn.active {
      background: rgba(74, 144, 226, 0.5);
    }
    
    .test-labels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .test-label {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
      border-radius: 6px;
      border-left: 3px solid #4a90e2;
    }
    
    .test-label strong {
      color: #4a90e2;
    }
    
    .status {
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
    }
    
    .status.success {
      background: rgba(76, 175, 80, 0.2);
      border: 1px solid rgba(76, 175, 80, 0.4);
      color: #4caf50;
    }
    
    .status.error {
      background: rgba(244, 67, 54, 0.2);
      border: 1px solid rgba(244, 67, 54, 0.4);
      color: #f44336;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üåê –¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤ ProGran3</h1>
    
    <div class="test-section">
      <h2>–ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤</h2>
      <div class="language-buttons">
        <button class="lang-btn active" onclick="changeLanguage('uk')">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
        <button class="lang-btn" onclick="changeLanguage('en')">üá∫üá∏ English</button>
        <button class="lang-btn" onclick="changeLanguage('pl')">üáµüá± Polski</button>
      </div>
      <div id="current-language" class="status success">
        –ü–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞: <strong>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</strong>
      </div>
    </div>
    
    <div class="test-section">
      <h2>–¢–µ—Å—Ç –ª–µ–π–±–ª—ñ–≤</h2>
      <div class="test-labels" id="test-labels">
        <!-- –õ–µ–π–±–ª–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ —á–µ—Ä–µ–∑ JavaScript -->
      </div>
    </div>
    
    <div class="test-section">
      <h2>–°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤</h2>
      <div id="translation-status" class="status">
        –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞...
      </div>
    </div>
  </div>

  <!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –º–æ–¥—É–ª—ñ -->
  <script src="i18n/I18nManager.js"></script>
  <script src="modules/ui/LanguageSwitcher.js"></script>
  
  <script>
    let currentLang = 'uk';
    let translations = {};
    
    // –¢–µ—Å—Ç–æ–≤—ñ –ª–µ–π–±–ª–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
    const testLabels = [
      'labels.width_mode',
      'labels.thickness_mm',
      'labels.width_mm',
      'labels.north_side_mm',
      'labels.south_side_mm',
      'labels.east_side_mm',
      'labels.west_side_mm',
      'labels.laying_method',
      'labels.frame_width_mm',
      'labels.overhang_mm',
      'labels.thickness',
      'labels.size_cm',
      'labels.seam',
      'labels.height_mm',
      'labels.depth_mm',
      'labels.post_height_mm',
      'labels.post_size_mm',
      'labels.panel_height_mm',
      'labels.panel_length_mm',
      'labels.panel_thickness_mm',
      'labels.intermediate_posts_count',
      'labels.back_side',
      'labels.entrance',
      'labels.side_sides',
      'labels.size_settings',
      'buttons.uniform_width',
      'buttons.custom_width',
      'buttons.frame_4_parts',
      'buttons.modular_tiling',
      'buttons.thickness_2cm',
      'buttons.thickness_3cm',
      'buttons.thickness_4cm',
      'buttons.thickness_5cm',
      'buttons.seam_2mm',
      'buttons.seam_3mm',
      'buttons.seam_4mm',
      'buttons.seam_5mm',
      'buttons.create_foundation',
      'buttons.create_blind_area',
      'buttons.add_tiles',
      'buttons.add_cladding',
      'buttons.add_stand',
      'buttons.update_size',
      'buttons.add_stele',
      'buttons.add_flowerbed',
      'buttons.add_gravestone',
      'buttons.create_corner_fence',
      'buttons.create_perimeter_fence',
      'buttons.add_fence_decor',
      'buttons.refresh'
    ];
    
    async function initializeTest() {
      console.log('üöÄ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–µ—Å—Ç—É –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤...');
      
      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ I18nManager
      if (window.ProGran3 && window.ProGran3.I18n && window.ProGran3.I18n.Manager) {
        await window.ProGran3.I18n.Manager.init();
        console.log('‚úÖ I18nManager —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ');
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø–µ—Ä–µ–∫–ª–∞–¥–∏
        translations = window.ProGran3.I18n.Manager.getTranslations();
        console.log('üìö –ü–µ—Ä–µ–∫–ª–∞–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:', translations);
        
        // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateTestLabels();
        updateLanguageStatus();
        checkTranslationStatus();
      } else {
        console.error('‚ùå I18nManager –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
        document.getElementById('translation-status').innerHTML = 
          '<div class="status error">‚ùå –ü–æ–º–∏–ª–∫–∞: I18nManager –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>';
      }
    }
    
    function changeLanguage(lang) {
      console.log(`üîÑ –ó–º—ñ–Ω–∞ –º–æ–≤–∏ –Ω–∞: ${lang}`);
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –∫–Ω–æ–ø–∫—É
      document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      // –ó–º—ñ–Ω—é—î–º–æ –º–æ–≤—É
      if (window.ProGran3 && window.ProGran3.I18n && window.ProGran3.I18n.Manager) {
        window.ProGran3.I18n.Manager.changeLanguage(lang);
        currentLang = lang;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –ø–µ—Ä–µ–∫–ª–∞–¥–∏
        translations = window.ProGran3.I18n.Manager.getTranslations();
        
        // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateTestLabels();
        updateLanguageStatus();
        checkTranslationStatus();
      }
    }
    
    function updateTestLabels() {
      const container = document.getElementById('test-labels');
      container.innerHTML = '';
      
      testLabels.forEach(labelKey => {
        const labelDiv = document.createElement('div');
        labelDiv.className = 'test-label';
        
        const translation = getNestedTranslation(translations, labelKey);
        const status = translation ? '‚úÖ' : '‚ùå';
        
        labelDiv.innerHTML = `
          <strong>${labelKey}:</strong><br>
          ${status} ${translation || '–ù–ï –ó–ù–ê–ô–î–ï–ù–û'}
        `;
        
        container.appendChild(labelDiv);
      });
    }
    
    function updateLanguageStatus() {
      const statusDiv = document.getElementById('current-language');
      const langNames = {
        'uk': '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞',
        'en': 'English', 
        'pl': 'Polski'
      };
      
      statusDiv.innerHTML = `
        –ü–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞: <strong>${langNames[currentLang]}</strong>
      `;
    }
    
    function checkTranslationStatus() {
      const statusDiv = document.getElementById('translation-status');
      let missingCount = 0;
      let totalCount = testLabels.length;
      
      testLabels.forEach(labelKey => {
        const translation = getNestedTranslation(translations, labelKey);
        if (!translation) {
          missingCount++;
        }
      });
      
      if (missingCount === 0) {
        statusDiv.innerHTML = `
          <div class="status success">
            ‚úÖ –í—Å—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ! (${totalCount}/${totalCount})
          </div>
        `;
      } else {
        statusDiv.innerHTML = `
          <div class="status error">
            ‚ùå –í—ñ–¥—Å—É—Ç–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏: ${missingCount} –∑ ${totalCount}
          </div>
        `;
      }
    }
    
    function getNestedTranslation(obj, path) {
      return path.split('.').reduce((current, key) => {
        return current && current[key] !== undefined ? current[key] : null;
      }, obj);
    }
    
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
    document.addEventListener('DOMContentLoaded', initializeTest);
  </script>
</body>
</html>
