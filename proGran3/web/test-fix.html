<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProGran3 - –¢–µ—Å—Ç –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #ccc;
        }
        .test-result.pass {
            background-color: #d4edda;
            border-left-color: #28a745;
        }
        .test-result.fail {
            background-color: #f8d7da;
            border-left-color: #dc3545;
        }
        .test-result.info {
            background-color: #d1ecf1;
            border-left-color: #17a2b8;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß –¢–µ—Å—Ç –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è updateSummaryTable</h1>
        <p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ "Cannot read properties of null"</p>
        
        <div id="test-results"></div>
        
        <button onclick="runTest()" style="
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        ">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç</button>
    </div>

    <!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –º–æ–¥—É–ª—ñ -->
    <script src="modules/core/Config.js"></script>
    <script src="modules/core/Logger.js"></script>
    <script src="modules/core/StateManager.js"></script>
    <script src="modules/utils/Helpers.js"></script>
    <script src="modules/utils/Validation.js"></script>
    <script src="modules/utils/Units.js"></script>
    <script src="modules/communication/SketchUpBridge.js"></script>
    <script src="modules/ui/Tabs.js"></script>
    <script src="modules/ui/Panels.js"></script>
    <script src="modules/ui/SummaryTable.js"></script>

    <script>
        function addTestResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
        }

        function runTest() {
            const results = document.getElementById('test-results');
            results.innerHTML = '';
            
            addTestResult('üöÄ –ü–æ—á–∞—Ç–æ–∫ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...', 'info');
            
            try {
                // –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —â–æ –º–æ–¥—É–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ
                if (window.ProGran3 && window.ProGran3.UI && window.ProGran3.UI.SummaryTable) {
                    addTestResult('‚úÖ SummaryTable –º–æ–¥—É–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'pass');
                } else {
                    addTestResult('‚ùå SummaryTable –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'fail');
                    return;
                }
                
                // –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —â–æ —Ñ—É–Ω–∫—Ü—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∞
                if (typeof window.ProGran3.UI.SummaryTable.updateSummaryTable === 'function') {
                    addTestResult('‚úÖ updateSummaryTable —Ñ—É–Ω–∫—Ü—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∞', 'pass');
                } else {
                    addTestResult('‚ùå updateSummaryTable —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞', 'fail');
                    return;
                }
                
                // –¢–µ—Å—Ç 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
                if (typeof window.updateSummaryTable === 'function') {
                    addTestResult('‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è updateSummaryTable –¥–æ—Å—Ç—É–ø–Ω–∞', 'pass');
                } else {
                    addTestResult('‚ùå –ì–ª–æ–±–∞–ª—å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è updateSummaryTable –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞', 'fail');
                }
                
                // –¢–µ—Å—Ç 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó (–±–µ–∑ –ø–æ–º–∏–ª–æ–∫)
                try {
                    // –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é - –≤–æ–Ω–∞ –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –ø–∞–¥–∞—Ç–∏ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ
                    window.ProGran3.UI.SummaryTable.updateSummaryTable();
                    addTestResult('‚úÖ updateSummaryTable –≤–∏–∫–ª–∏–∫–∞–Ω–æ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫', 'pass');
                } catch (error) {
                    addTestResult(`‚ùå updateSummaryTable –≤–∏–∫–ª–∏–∫–∞–Ω–æ –∑ –ø–æ–º–∏–ª–∫–æ—é: ${error.message}`, 'fail');
                }
                
                // –¢–µ—Å—Ç 5: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è getSummaryData
                try {
                    const summaryData = window.ProGran3.UI.SummaryTable.getSummaryData();
                    if (typeof summaryData === 'object') {
                        addTestResult('‚úÖ getSummaryData –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±\'—î–∫—Ç', 'pass');
                    } else {
                        addTestResult('‚ùå getSummaryData –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±\'—î–∫—Ç', 'fail');
                    }
                } catch (error) {
                    addTestResult(`‚ùå getSummaryData –≤–∏–∫–ª–∏–∫–∞–Ω–æ –∑ –ø–æ–º–∏–ª–∫–æ—é: ${error.message}`, 'fail');
                }
                
                // –¢–µ—Å—Ç 6: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è clearSummaryTable
                try {
                    window.ProGran3.UI.SummaryTable.clearSummaryTable();
                    addTestResult('‚úÖ clearSummaryTable –≤–∏–∫–ª–∏–∫–∞–Ω–æ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫', 'pass');
                } catch (error) {
                    addTestResult(`‚ùå clearSummaryTable –≤–∏–∫–ª–∏–∫–∞–Ω–æ –∑ –ø–æ–º–∏–ª–∫–æ—é: ${error.message}`, 'fail');
                }
                
                addTestResult('üèÅ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'info');
                addTestResult('‚úÖ –ü–æ–º–∏–ª–∫–∞ "Cannot read properties of null" –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞!', 'pass');
                
            } catch (error) {
                addTestResult(`‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –≤ —Ç–µ—Å—Ç—ñ: ${error.message}`, 'fail');
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—î–º–æ —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('load', () => {
            setTimeout(runTest, 500);
        });
    </script>
</body>
</html>
