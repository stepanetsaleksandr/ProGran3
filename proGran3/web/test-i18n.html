<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>ProGran3 I18n Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f5f5;
    }
    .test-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .test-button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    .test-button:hover {
      background: #0056b3;
    }
    .test-result {
      margin: 10px 0;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 3px;
    }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .info { background: #d1ecf1; color: #0c5460; }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üåç ProGran3 I18n Test</h1>
    
    <div class="test-section">
      <h2>–ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤</h2>
      <p>–ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ –ø–æ–≤–∏–Ω–µ–Ω –∑'—è–≤–∏—Ç–∏—Å—è –ø–æ—Ä—É—á –∑ –ø–µ—Ä–µ–º–∏–∫–∞—á–µ–º –æ–¥–∏–Ω–∏—Ü—å —Ç–∞ –Ω–µ —Ö–æ–≤–∞—Ç–∏—Å—è –∑–∞ –º–µ–∂—É –∑–∞–≥–æ–ª–æ–≤–∫–∞:</p>
      <div style="border: 2px dashed #ccc; padding: 20px; margin: 10px 0; text-align: center;">
        <div style="display: flex; justify-content: space-between; align-items: center; background: #f8f9fa; padding: 10px; border-radius: 5px;">
          <div style="flex: 1; text-align: left;"><strong>ProGran</strong></div>
          <div style="flex: 1; text-align: right; background: #e9ecef; padding: 5px; border-radius: 3px;">
            <strong>–ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ + –û–¥–∏–Ω–∏—Ü—ñ</strong>
          </div>
        </div>
      </div>
      <!-- –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ –±—É–¥–µ –¥–æ–¥–∞–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
    </div>
    
    <div class="test-section">
      <h2>–¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤</h2>
      <div class="test-result" id="translation-test">
        <p><strong>–ü–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞:</strong> <span id="current-lang">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span></p>
        <p><strong>–¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—É:</strong> <span id="test-translation">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span></p>
      </div>
      
      <button class="test-button" onclick="testTranslations()">–¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤</button>
      <button class="test-button" onclick="testLanguageChange('uk')">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
      <button class="test-button" onclick="testLanguageChange('pl')">Polski</button>
      <button class="test-button" onclick="testLanguageChange('en')">English</button>
    </div>
    
    <div class="test-section">
      <h2>–¢–µ—Å—Ç data-i18n –∞—Ç—Ä–∏–±—É—Ç—ñ–≤</h2>
      <div class="test-result">
        <p data-i18n="ui.foundation">–§—É–Ω–¥–∞–º–µ–Ω—Ç</p>
        <p data-i18n="ui.stele">–°—Ç–µ–ª–∞</p>
        <p data-i18n="ui.flowerbed">–ö–≤—ñ—Ç–Ω–∏–∫</p>
        <button data-i18n="buttons.create">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
        <button data-i18n="buttons.add">–î–æ–¥–∞—Ç–∏</button>
      </div>
    </div>
    
    <div class="test-section">
      <h2>–¢–µ—Å—Ç —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è</h2>
      <div class="test-result">
        <p><strong>–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:</strong></p>
        <ul>
          <li>‚úÖ –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π –ø–æ—Ä—É—á –∑ –ø–µ—Ä–µ–º–∏–∫–∞—á–µ–º –æ–¥–∏–Ω–∏—Ü—å</li>
          <li>‚úÖ Dropdown –Ω–µ —Ö–æ–≤–∞—î—Ç—å—Å—è –∑–∞ –º–µ–∂—É –∑–∞–≥–æ–ª–æ–≤–∫–∞</li>
          <li>‚úÖ Dropdown –ø–æ–∑–∏—Ü—ñ–æ–Ω—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–≤–≥–æ—Ä—É/–≤–Ω–∏–∑)</li>
          <li>‚úÖ –ù–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö dropdown —Ü–µ–Ω—Ç—Ä—É—î—Ç—å—Å—è</li>
          <li>‚úÖ –ù–∞–∑–≤–∞ "ProGran" –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–∞ —Å–≤–æ—î–º—É –º—ñ—Å—Ü—ñ</li>
        </ul>
        <button class="test-button" onclick="testPositioning()">–¢–µ—Å—Ç —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è</button>
      </div>
    </div>
    
    <div class="test-section">
      <h2>–õ–æ–≥–∏</h2>
      <div id="test-logs" class="test-result" style="height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;">
        <div>üîç –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –ª–æ–≥—ñ–≤...</div>
      </div>
    </div>
  </div>

  <!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –º–æ–¥—É–ª—ñ -->
  <script src="modules/core/Logger.js"></script>
  <script src="modules/ui/LanguageSwitcher.js"></script>
  <script src="i18n/I18nManager.js"></script>
  
  <script>
    // –ü—Ä–æ—Å—Ç–∏–π –ª–æ–≥–≥–µ—Ä –¥–ª—è —Ç–µ—Å—Ç—ñ–≤
    function logTest(message, type = 'info') {
      const logs = document.getElementById('test-logs');
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = type;
      logEntry.textContent = `[${timestamp}] ${message}`;
      logs.appendChild(logEntry);
      logs.scrollTop = logs.scrollHeight;
    }
    
    // –¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤
    function testTranslations() {
      logTest('üß™ –¢–µ—Å—Ç—É—î–º–æ –ø–µ—Ä–µ–∫–ª–∞–¥–∏...', 'info');
      
      if (window.ProGran3 && window.ProGran3.I18n && window.ProGran3.I18n.Manager) {
        const manager = window.ProGran3.I18n.Manager;
        const currentLang = manager.getCurrentLanguage();
        
        document.getElementById('current-lang').textContent = currentLang;
        document.getElementById('test-translation').textContent = manager.t('ui.foundation');
        
        logTest(`‚úÖ –ü–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞: ${currentLang}`, 'success');
        logTest(`‚úÖ –ü–µ—Ä–µ–∫–ª–∞–¥ "ui.foundation": ${manager.t('ui.foundation')}`, 'success');
        logTest(`‚úÖ –ü–µ—Ä–µ–∫–ª–∞–¥ "buttons.create": ${manager.t('buttons.create')}`, 'success');
      } else {
        logTest('‚ùå I18nManager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π', 'error');
      }
    }
    
    // –¢–µ—Å—Ç –∑–º—ñ–Ω–∏ –º–æ–≤–∏
    async function testLanguageChange(lang) {
      logTest(`üîÑ –ó–º—ñ–Ω—é—î–º–æ –º–æ–≤—É –Ω–∞: ${lang}`, 'info');
      
      if (window.ProGran3 && window.ProGran3.I18n && window.ProGran3.I18n.Manager) {
        try {
          const success = await window.ProGran3.I18n.Manager.changeLanguage(lang);
          if (success) {
            logTest(`‚úÖ –ú–æ–≤—É —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞: ${lang}`, 'success');
            testTranslations(); // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–µ—Å—Ç
          } else {
            logTest(`‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–º—ñ–Ω–∏—Ç–∏ –º–æ–≤—É –Ω–∞: ${lang}`, 'error');
          }
        } catch (error) {
          logTest(`‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–º—ñ–Ω–∏ –º–æ–≤–∏: ${error.message}`, 'error');
        }
      } else {
        logTest('‚ùå I18nManager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π', 'error');
      }
    }
    
    // –¢–µ—Å—Ç —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è
    function testPositioning() {
      logTest('üß™ –¢–µ—Å—Ç—É—î–º–æ —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –ø–µ—Ä–µ–º–∏–∫–∞—á–∞ –º–æ–≤...', 'info');
      
      const switcher = document.getElementById('language-switcher');
      if (switcher) {
        const rect = switcher.getBoundingClientRect();
        const headerControls = document.querySelector('.header-controls');
        
        if (headerControls) {
          const controlsRect = headerControls.getBoundingClientRect();
          const isInControls = rect.left >= controlsRect.left && rect.right <= controlsRect.right;
          
          if (isInControls) {
            logTest('‚úÖ –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π –≤ header-controls', 'success');
          } else {
            logTest('‚ùå –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ –ù–ï –≤ header-controls', 'error');
          }
        }
        
        const dropdown = switcher.querySelector('.language-dropdown');
        if (dropdown) {
          const dropdownRect = dropdown.getBoundingClientRect();
          const header = document.querySelector('header');
          
          if (header) {
            const headerRect = header.getBoundingClientRect();
            const isVisible = dropdownRect.top >= headerRect.top - 10;
            
            if (isVisible) {
              logTest('‚úÖ Dropdown –Ω–µ —Ö–æ–≤–∞—î—Ç—å—Å—è –∑–∞ –º–µ–∂—É –∑–∞–≥–æ–ª–æ–≤–∫–∞', 'success');
            } else {
              logTest('‚ùå Dropdown —Ö–æ–≤–∞—î—Ç—å—Å—è –∑–∞ –º–µ–∂—É –∑–∞–≥–æ–ª–æ–≤–∫–∞', 'error');
            }
          }
        }
        
        logTest(`üìç –ü–æ–∑–∏—Ü—ñ—è –ø–µ—Ä–µ–º–∏–∫–∞—á–∞: x=${Math.round(rect.left)}, y=${Math.round(rect.top)}`, 'info');
      } else {
        logTest('‚ùå –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ', 'error');
      }
    }
    
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    window.onload = async function() {
      logTest('üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ i18n...', 'info');
      
      try {
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ I18nManager
        if (window.ProGran3 && window.ProGran3.I18n && window.ProGran3.I18n.Manager) {
          await window.ProGran3.I18n.Manager.init();
          logTest('‚úÖ I18nManager —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ', 'success');
        }
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –ø–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤
        if (window.ProGran3 && window.ProGran3.UI && window.ProGran3.UI.LanguageSwitcher) {
          window.ProGran3.UI.LanguageSwitcher.init();
          logTest('‚úÖ –ü–µ—Ä–µ–º–∏–∫–∞—á –º–æ–≤ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ', 'success');
        }
        
        // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–µ—Å—Ç –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤
        setTimeout(testTranslations, 500);
        
        // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–µ—Å—Ç —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è
        setTimeout(testPositioning, 1000);
        
      } catch (error) {
        logTest(`‚ùå –ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó: ${error.message}`, 'error');
      }
    };
  </script>
</body>
</html>
