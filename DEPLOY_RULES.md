# Правила деплою ProGran3

## Загальні принципи

1. **Сервер** - деплоїться автоматично через Vercel CLI
2. **Плагін** - деплоїться вручну через `deploy_simple.bat`
3. **Після деплою сервера** - оновлювати посилання в плагіні

## Процес деплою

### 1. Деплой сервера
```bash
# В папці server/
vercel --prod
```

### 2. Оновлення посилань в плагіні
Після деплою сервера отримати новий URL і оновити:
- `plugin/proGran3/security/license_manager.rb` - `@base_url`
- `plugin/proGran3/callback_manager.rb` - URL для heartbeat

### 3. Деплой плагіна
```bash
# В папці plugin/
.\deploy_simple.bat
```

## Структура файлів

```
ProGran3/
├── server/                 # Next.js сервер
│   ├── src/
│   ├── package.json
│   └── vercel.json
├── plugin/                 # SketchUp плагін
│   ├── proGran3.rb
│   ├── proGran3/
│   └── deploy_simple.bat
└── DEPLOY_RULES.md         # Цей файл
```

## Важливі зауваження

- **НЕ комітити** файли деплою в git
- **НЕ пушити** автоматично після деплою
- **Завжди** оновлювати посилання після деплою сервера
- **Тестувати** плагін після оновлення посилань

## Команди для швидкого деплою

```bash
# Деплой сервера
cd server
vercel --prod

# Отримати новий URL
vercel ls

# Оновити посилання в плагіні (вручну)
# 1. Відкрити license_manager.rb
# 2. Оновити @base_url
# 3. Відкрити callback_manager.rb  
# 4. Оновити URL для heartbeat

# Деплой плагіна
cd ../plugin
.\deploy_simple.bat
```

## Перевірка після деплою

1. Перевірити, що сервер працює
2. Перевірити, що плагін підключається до нового сервера
3. Протестувати активацію ліцензії
4. Перевірити heartbeat
